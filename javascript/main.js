/*
*  termi
*  Copyright ¬© wearetermi 2020
*  All rights reserved.
*  Licensed under GPL-3 license.
*/

// Set the motd

termi.setText(`
<center>
<div style="font-family: monospace, fixed; font-weight: bold;">
<span style=";color:#f5f">&#9484;&#9472;</span><span style=";color:#f55">&#9472;&#9472;</span><span style=";color:#ff5">&#9472;&#9472;</span><span style=";color:#5f5">&#9472;&#9472;</span><span style=";color:#5ff">&#9472;&#9472;</span><span style=";color:#55f">&#9472;&#9472;</span><span style=";color:#f5f">&#9472;&#9472;</span><span style=";color:#f55">&#9472;&#9472;</span><span style=";color:#ff5">&#9472;&#9472;</span><span style=";color:#5f5">&#9472;&#9472;</span><span style=";color:#5ff">&#9472;&#9472;</span><span style=";color:#55f">&#9472;&#9472;</span><span style=";color:#f5f">&#9472;&#9472;</span><span style=";color:#f55">&#9472;&#9472;</span><span style=";color:#ff5">&#9472;&#9472;</span><span style=";color:#5f5">&#9472;&#9472;</span><span style=";color:#5ff">&#9472;&#9472;</span><span style=";color:#55f">&#9472;&#9472;</span><span style=";color:#f5f">&#9472;&#9472;</span><span style=";color:#f55">&#9472;&#9472;</span><span style=";color:#ff5">&#9472;&#9472;</span><span style=";color:#5f5">&#9472;&#9488;</span><br />
<span style=";color:#f55">&#9474;</span><span style="">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span><span style=";color:#5ff">&#9474;</span><br />
<span style=";color:#ff5">&#9474;m</span><span style=";color:#5f5">mm</span><span style=";color:#5ff">mm</span><span style=";color:#55f">mm</span><span style="">&#160;</span><span style=";color:#f5f">m</span><span style=";color:#f55">mm</span><span style=";color:#ff5">mm</span><span style=";color:#5f5">m</span><span style="">&#160;</span><span style=";color:#5ff">mm</span><span style=";color:#55f">mm</span><span style=";color:#f5f">m</span><span style="">&#160;&#160;</span><span style=";color:#f55">m</span><span style="">&#160;&#160;&#160;&#160;</span><span style=";color:#5ff">m</span><span style="">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span><span style=";color:#ff5">m</span><span style=";color:#5f5">mm</span><span style=";color:#5ff">mm</span><span style="">&#160;</span><span style=";color:#55f">&#9474;</span><br />
<span style=";color:#5f5">&#9474;</span><span style="">&#160;&#160;&#160;</span><span style=";color:#55f">#</span><span style="">&#160;&#160;&#160;&#160;</span><span style=";color:#f55">#</span><span style="">&#160;&#160;&#160;&#160;&#160;&#160;</span><span style=";color:#55f">#</span><span style="">&#160;&#160;&#160;</span><span style=";color:#f55">&quot;#</span><span style="">&#160;</span><span style=";color:#ff5">#</span><span style=";color:#5f5">#</span><span style="">&#160;&#160;</span><span style=";color:#5ff">#</span><span style=";color:#55f">#</span><span style="">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span><span style=";color:#5ff">#</span><span style="">&#160;&#160;&#160;</span><span style=";color:#f5f">&#9474;</span><br />
<span style=";color:#5ff">&#9474;</span><span style="">&#160;&#160;&#160;</span><span style=";color:#f5f">#</span><span style="">&#160;&#160;&#160;&#160;</span><span style=";color:#ff5">#</span><span style=";color:#5f5">mm</span><span style=";color:#5ff">mm</span><span style=";color:#55f">m</span><span style="">&#160;</span><span style=";color:#f5f">#m</span><span style=";color:#f55">mm</span><span style=";color:#ff5">m&quot;</span><span style="">&#160;</span><span style=";color:#5f5">#</span><span style="">&#160;</span><span style=";color:#5ff">#</span><span style=";color:#55f">#</span><span style="">&#160;</span><span style=";color:#f5f">#</span><span style="">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span><span style=";color:#55f">#</span><span style="">&#160;&#160;&#160;</span><span style=";color:#f55">&#9474;</span><br />
<span style=";color:#55f">&#9474;</span><span style="">&#160;&#160;&#160;</span><span style=";color:#f55">#</span><span style="">&#160;&#160;&#160;&#160;</span><span style=";color:#5f5">#</span><span style="">&#160;&#160;&#160;&#160;&#160;&#160;</span><span style=";color:#f55">#</span><span style="">&#160;&#160;&#160;</span><span style=";color:#5f5">&quot;m</span><span style="">&#160;</span><span style=";color:#5ff">#</span><span style="">&#160;</span><span style=";color:#55f">&quot;</span><span style=";color:#f5f">&quot;</span><span style="">&#160;</span><span style=";color:#f55">#</span><span style="">&#160;&#160;</span><span style=";color:#ff5">&quot;</span><span style=";color:#5f5">&quot;&quot;</span><span style="">&#160;&#160;&#160;&#160;&#160;</span><span style=";color:#f5f">#</span><span style="">&#160;&#160;&#160;</span><span style=";color:#ff5">&#9474;</span><br />
<span style=";color:#f5f">&#9474;</span><span style="">&#160;&#160;&#160;</span><span style=";color:#ff5">#</span><span style="">&#160;&#160;&#160;&#160;</span><span style=";color:#5ff">#</span><span style=";color:#55f">mm</span><span style=";color:#f5f">mm</span><span style=";color:#f55">m</span><span style="">&#160;</span><span style=";color:#ff5">#</span><span style="">&#160;&#160;&#160;&#160;</span><span style=";color:#5ff">&quot;</span><span style="">&#160;</span><span style=";color:#55f">#</span><span style="">&#160;&#160;&#160;&#160;</span><span style=";color:#ff5">#</span><span style="">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span><span style=";color:#f5f">m</span><span style=";color:#f55">m#</span><span style=";color:#ff5">mm</span><span style="">&#160;</span><span style=";color:#5f5">&#9474;</span><br />
<span style=";color:#f55">&#9474;</span><span style="">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span><span style=";color:#5ff">&#9474;</span><br />
<span style=";color:#ff5">&#9474;</span><span style="">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span><span style=";color:#55f">&#9474;</span><br />
<span style=";color:#5f5">&#9492;&#9472;</span><span style=";color:#5ff">&#9472;&#9472;</span><span style=";color:#55f">&#9472;&#9472;</span><span style=";color:#f5f">&#9472;&#9472;</span><span style=";color:#f55">&#9472;&#9472;</span><span style=";color:#ff5">&#9472;&#9472;</span><span style=";color:#5f5">&#9472;&#9472;</span><span style=";color:#5ff">&#9472;&#9472;</span><span style=";color:#55f">&#9472;&#9472;</span><span style=";color:#f5f">&#9472;&#9472;</span><span style=";color:#f55">&#9472;&#9472;</span><span style=";color:#ff5">&#9472;&#9472;</span><span style=";color:#5f5">&#9472;&#9472;</span><span style=";color:#5ff">&#9472;&#9472;</span><span style=";color:#55f">&#9472;&#9472;</span><span style=";color:#f5f">&#9472;&#9472;</span><span style=";color:#f55">&#9472;&#9472;</span><span style=";color:#ff5">&#9472;&#9472;</span><span style=";color:#5f5">&#9472;&#9472;</span><span style=";color:#5ff">&#9472;&#9472;</span><span style=";color:#55f">&#9472;&#9472;</span><span style=";color:#f5f">&#9472;&#9496;</span><br />
</div>
ùïßùüò.ùüò.ùüô
</center>
<br>
${termi.shell}`)

// Scroll down when you can
setInterval(() => window.scrollTo(0, document.body.scrollHeight))

// Listen for keypresses
document.addEventListener("keydown", function onEvent(event) {
	
	// Arguments used in the code
	const args = termitext.innerHTML.split(termi.shell).slice(-1).join().split(" ");

	// Add a space if space is pressed
	if (event.code === "Space") {
		termi.send(" ")
		return;
	}

	// If enter is pressed then
	if (event.code === "Enter") {
	
		// Run command
		if (commandHandle(args, termi)) {

			// If exists, it'll launch the command and return nothiong.
			return;
		} else {
	
			// But if it does not exist, it'll go to here.
			// Check if arguments are empty, and if they are just print a new line
			if (args.join("") === "") {
				termi.send(`<br>${termi.shell}`)
				return;
			}
			// Scream at the user if the command isn't correct.
			termi.send(`<br>termi: ${args.join(" ")}: command not found<br>${termi.shell}`)
			return;
		}
	}
	
	// Delete a charecter from the whole text if backspace is pressed
	if (event.code === "Backspace") {
		termi.setText(termitext.innerHTML.substr(0, termitext.innerHTML.length - 1));
		return;
	}

	// Launch the history handle when the user has pressed ArrowUp
	if (event.code === "ArrowUp") {
		historyHandle("up", termi, termitext)
	}
	
	// If nothing matches, test if the key is one charecter. If it is, then print it, but if it's not, then don't.
	let isOneChar=e=>!(e.split("").length>1);
	if(isOneChar(event.key)) {
		termitext.innerHTML = termitext.innerHTML + event.key
	} else {
		return;
	}

});
